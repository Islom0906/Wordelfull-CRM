"use strict";(self.webpackChunkwonderfullcity_crm=self.webpackChunkwonderfullcity_crm||[]).push([[153],{84268:(e,l,s)=>{s.d(l,{A:()=>r});s(65043);var a=s(50289),o=s(33307),t=s(70579);const r=e=>{let{label:l,name:s,required:r,required_text:n,warning:d}=e;return(0,t.jsx)(a.A.Item,{label:d?(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{children:l}),(0,t.jsx)("br",{}),(0,t.jsx)("p",{children:d})]}):(0,t.jsx)("div",{children:l}),name:s,rules:[{required:r,message:n}],children:(0,t.jsx)(o.A,{})})}},25153:(e,l,s)=>{s.r(l),s.d(l,{default:()=>x});var a=s(65043),o=s(50289),t=s(48193),r=s(47419),n=s(11645),d=s(94406),i=s(89421),u=s(82907),c=s(59888),m=s(92528),p=s(73216),v=s(14556),h=s(36213),f=s(84268),A=s(70579);const g={name:"",houseId:null},x=()=>{const[e]=o.A.useForm(),l=(0,p.Zp)(),{editId:s}=(0,v.d4)((e=>e.editData)),x=(0,v.wA)(),[y,b]=(0,a.useState)(null),{data:j,refetch:I}=(0,u.useQuery)("get-slot",(()=>c.A.getData("/Slot")),{enabled:!1}),{data:w,refetch:F}=(0,u.useQuery)("get-house",(()=>c.A.getData("/House?slotId=".concat(y))),{enabled:!1}),{mutate:S,data:E,isLoading:V,isSuccess:C}=(0,u.useMutation)((e=>{let{url:l,data:s}=e;return c.A.postData(l,s)}),{onSuccess:()=>{t.Ay.success("Success")},onError:e=>{for(let l in e.response.data)t.Ay.error("".concat(l,": ").concat(e.response.data[l]))}}),{isLoading:D,data:q,refetch:L,isSuccess:k}=(0,u.useQuery)(["edit-floor",s],(()=>c.A.getDataByID("/Floor",s)),{enabled:!1}),{mutate:M,isLoading:_,data:Q,isSuccess:T}=(0,u.useMutation)((e=>{let{url:l,data:s,id:a}=e;return c.A.editData(l,s,a)}),{onSuccess:()=>{t.Ay.success("Success")},onError:e=>{for(let l in e.response.data)t.Ay.error("".concat(l,": ").concat(e.response.data[l]))}});(0,a.useEffect)((()=>{y&&F()}),[y]),(0,a.useEffect)((()=>{T&&x({type:h.aT,payload:""}),(C||T)&&l("/floor")}),[E,Q]),(0,a.useEffect)((()=>{""!==s&&L()}),[s]),(0,a.useEffect)((()=>{""===s&&e.setFieldsValue(g),I()}),[]),(0,a.useEffect)((()=>{if(k){var l,s,a,o,t;const r={name:null===q||void 0===q?void 0:q.name,slotId:null===q||void 0===q||null===(l=q.house)||void 0===l||null===(s=l.slot)||void 0===s?void 0:s.id,houseId:null===q||void 0===q||null===(a=q.house)||void 0===a?void 0:a.id};b(null===q||void 0===q||null===(o=q.house)||void 0===o||null===(t=o.slot)||void 0===t?void 0:t.id),e.setFieldsValue(r)}}),[q]);(0,a.useEffect)((()=>{const l=JSON.parse(localStorage.getItem("myFormValues"));l&&(l.images=[],e.setFieldsValue(l));const s=()=>{localStorage.setItem("myFormValues",JSON.stringify(e.getFieldsValue()))};return window.addEventListener("beforeunload",s),()=>{localStorage.removeItem("editDataId"),localStorage.removeItem("myFormValues"),window.removeEventListener("beforeunload",s)}}),[]);const H=(0,a.useMemo)((()=>{var e;return null===j||void 0===j||null===(e=j.result)||void 0===e?void 0:e.map((e=>({value:null===e||void 0===e?void 0:e.id,label:null===e||void 0===e?void 0:e.name})))}),[j]),J=(0,a.useMemo)((()=>{var e;return null===w||void 0===w||null===(e=w.result)||void 0===e?void 0:e.map((e=>({value:null===e||void 0===e?void 0:e.id,label:null===e||void 0===e?void 0:e.name})))}),[w]);return(0,A.jsx)("div",{children:V||D||_?(0,A.jsx)(m.HE,{}):(0,A.jsxs)(o.A,{form:e,name:"basic",labelCol:{span:24},wrapperCol:{span:24},style:{maxWidth:"100%"},initialValues:g,onFinish:e=>{const l={name:e.name,houseId:e.houseId};k?M({url:"/Floor",data:l,id:s}):S({url:"/Floor/",data:l})},onFinishFailed:e=>{console.log("Failed:",e)},autoComplete:"off",children:[(0,A.jsxs)(r.A,{gutter:20,children:[(0,A.jsx)(n.A,{span:8,children:(0,A.jsx)(o.A.Item,{label:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0441\u043b\u043e\u0442",name:"slotId",rules:[{required:!0,message:"\u0412\u044b \u0434\u043e\u043b\u0436\u043d\u044b \u0432\u044b\u0431\u0440\u0430\u0442\u044c \u0441\u043b\u043e\u0442"}],wrapperCol:{span:24},children:(0,A.jsx)(d.A,{style:{width:"100%"},placeholder:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043e\u0434\u043d\u0443 \u0441\u043b\u043e\u0442",optionLabelProp:"label",onChange:l=>{e.setFieldsValue({houseId:""}),b(l)},options:H})})}),(0,A.jsx)(n.A,{span:8,children:(0,A.jsx)(o.A.Item,{label:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0434\u043e\u043c",name:"houseId",rules:[{required:!0,message:"\u0412\u044b \u0434\u043e\u043b\u0436\u043d\u044b \u0432\u044b\u0431\u0440\u0430\u0442\u044c \u0434\u043e\u043c"}],wrapperCol:{span:24},children:(0,A.jsx)(d.A,{style:{width:"100%"},placeholder:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043e\u0434\u043d\u0443 \u0434\u043e\u043c",optionLabelProp:"label",options:J})})}),(0,A.jsx)(n.A,{span:8,children:(0,A.jsx)(f.A,{required:!0,required_text:"\u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u044d\u0442\u0430\u0436",label:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u044d\u0442\u0430\u0436",name:"name"})})]}),(0,A.jsx)(i.A,{type:"primary",htmlType:"submit",style:{width:"100%",marginTop:"20px"},children:k?"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c":"\u0421\u043e\u0437\u0434\u0430\u0442\u044c"})]})})}},11645:(e,l,s)=>{s.d(l,{A:()=>a});const a=s(30227).A}}]);
//# sourceMappingURL=153.7cc7ccad.chunk.js.map